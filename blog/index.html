<!DOCTYPE HTML>
<html>

<head>
	<meta charset="utf-8">
	<title> Jared's Blog </title>
	<link rel="stylesheet" href="./style.css">
	<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300&display=swap" rel="stylesheet">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
	<div class="login__wrapper hidden">
		<div class="login__container">
			<div class="login__desc">
				<div class="login__title">Log In</div>
				<form class="login__form" method="POST" action="#">
					<div class="input__desc">USERNAME</div>
					<input type="input" id="username" required/>
					<div class="input__desc">PASSWORD</div>
					<input type="password" id="password" required/>
					<button class="form__btn" type="submit">SIGN IN</button>
				</form>
				<div id="warning__msg"></div>
			</div>
		</div>
	</div>
	<nav class="nav__bar">
		<div class="wrapper">
			<a class="icon" href="./index.html">Jared's Blog</a>
			<div class="link__btns btns1">
				<a class="link__btn" href="./all_blogs.html">文章列表</a>
				<a class="link__btn" href="#">分類專區</a>
				<a class="link__btn" href="./about_me.html">關於我</a>
			</div>
			<div class="link__btns btns2">
				<a class="link__btn logged__in hidden" id="admin__btn" href="#">管理後台</a>
				<a class="link__btn logged__in hidden" id="new__post__btn" href="#">發新文章</a>
				<a class="link__btn logged__in hidden" id="logout__btn" href="#">登出</a>
				<a class="link__btn logged__out" id="login__btn" href="#">登入</a>
			</div>
		</div>
	</nav>
	<div class="wrapper">
		<div class="banner">
			<div class="banner__desc">
				<div class="page__title">
					存放新聞之地
				</div>
				<div class="page__subtitle">
					Welcome to my news' blog
				</div>
			</div>
		</div>
	</div>
	<div class="wrapper blogs__wrapper">
		<div class="blogs__container">
			<div class="blog">
				<div class="title__row">
					<div class="blog__title">
						嗨～歡迎來到程式新手村 feat. 胡斯的異想世界
					</div>
					<button class="edit__btn logged__in hidden">編輯</button>
				</div>
				<div class="blog__details">
					<div class="clock__img"></div>
					<div class="blog__time">2020/07/01 10:15</div>
					<div class="blog__category">歷史公告</div>
				</div>
				<div class="blog__content">羅曼·羅蘭在不經意間這樣說過

					只有把抱怨環境的心情，化為上進的力量，才是成功的保證。
					帶著這句話，我們還要更加慎重的審視這個問題： 在這種困難的抉擇下，本人思來想去，寢食難安。我們一般認為，抓住了問題的關鍵，其他一切則會迎刃而解。
					
					郭沫若說過一句富有哲理的話，形成天才的決定因素應該是勤奮。這句話語雖然很短，但令我浮想聯翩。每個人都不得不面對這些問題。在面對這種問題時， 我認為， 生活中，若中午吃什麼出現了，我們就不得不考慮它出現了的事實。中午吃什麼，發生了會如何，不發生又會如何。我們一般認為，抓住了問題的關鍵，其他一切則會迎刃而解。我們都知道，只要有意義，那麼就必須慎重考慮。現在，解決中午吃什麼的問題，是非常非常重要的。所以， 那麼， 一般來講，我們都必須務必慎重的考慮考慮
				</div>
				<div class="last__row">
					<button class="more__btn">READ MORE</button>
				</div>
			</div><div class="blog">
				<div class="title__row">
					<div class="blog__title">
						嗨～歡迎來到程式新手村 feat. 胡斯的異想世界
					</div>
					<button class="edit__btn logged__in hidden">編輯</button>
				</div>
				<div class="blog__details">
					<div class="clock__img"></div>
					<div class="blog__time">2020/07/01 10:15</div>
					<div class="blog__category">歷史公告</div>
				</div>
				<div class="blog__content">羅曼·羅蘭在不經意間這樣說過

					只有把抱怨環境的心情，化為上進的力量，才是成功的保證。
					帶著這句話，我們還要更加慎重的審視這個問題： 在這種困難的抉擇下，本人思來想去，寢食難安。我們一般認為，抓住了問題的關鍵，其他一切則會迎刃而解。
					
					郭沫若說過一句富有哲理的話，形成天才的決定因素應該是勤奮。這句話語雖然很短，但令我浮想聯翩。每個人都不得不面對這些問題。在面對這種問題時， 我認為， 生活中，若中午吃什麼出現了，我們就不得不考慮它出現了的事實。中午吃什麼，發生了會如何，不發生又會如何。我們一般認為，抓住了問題的關鍵，其他一切則會迎刃而解。我們都知道，只要有意義，那麼就必須慎重考慮。現在，解決中午吃什麼的問題，是非常非常重要的。所以， 那麼， 一般來講，我們都必須務必慎重的考慮考慮
				</div>
				<div class="last__row">
					<button class="more__btn">READ MORE</button>
				</div>
			</div><div class="blog">
				<div class="title__row">
					<div class="blog__title">
						嗨～歡迎來到程式新手村 feat. 胡斯的異想世界
					</div>
					<button class="edit__btn logged__in hidden">編輯</button>
				</div>
				<div class="blog__details">
					<div class="clock__img"></div>
					<div class="blog__time">2020/07/01 10:15</div>
					<div class="blog__category">歷史公告</div>
				</div>
				<div class="blog__content">羅曼·羅蘭在不經意間這樣說過

					只有把抱怨環境的心情，化為上進的力量，才是成功的保證。
					帶著這句話，我們還要更加慎重的審視這個問題： 在這種困難的抉擇下，本人思來想去，寢食難安。我們一般認為，抓住了問題的關鍵，其他一切則會迎刃而解。
					
					郭沫若說過一句富有哲理的話，形成天才的決定因素應該是勤奮。這句話語雖然很短，但令我浮想聯翩。每個人都不得不面對這些問題。在面對這種問題時， 我認為， 生活中，若中午吃什麼出現了，我們就不得不考慮它出現了的事實。中午吃什麼，發生了會如何，不發生又會如何。我們一般認為，抓住了問題的關鍵，其他一切則會迎刃而解。我們都知道，只要有意義，那麼就必須慎重考慮。現在，解決中午吃什麼的問題，是非常非常重要的。所以， 那麼， 一般來講，我們都必須務必慎重的考慮考慮
				</div>
				<div class="last__row">
					<button class="more__btn">READ MORE</button>
				</div>
			</div><div class="blog">
				<div class="title__row">
					<div class="blog__title">
						嗨～歡迎來到程式新手村 feat. 胡斯的異想世界
					</div>
					<button class="edit__btn">編輯</button>
				</div>
				<div class="blog__details">
					<div class="clock__img"></div>
					<div class="blog__time">2020/07/01 10:15</div>
					<div class="blog__category">歷史公告</div>
				</div>
				<div class="blog__content">羅曼·羅蘭在不經意間這樣說過

					只有把抱怨環境的心情，化為上進的力量，才是成功的保證。
					帶著這句話，我們還要更加慎重的審視這個問題： 在這種困難的抉擇下，本人思來想去，寢食難安。我們一般認為，抓住了問題的關鍵，其他一切則會迎刃而解。
					
					郭沫若說過一句富有哲理的話，形成天才的決定因素應該是勤奮。這句話語雖然很短，但令我浮想聯翩。每個人都不得不面對這些問題。在面對這種問題時， 我認為， 生活中，若中午吃什麼出現了，我們就不得不考慮它出現了的事實。中午吃什麼，發生了會如何，不發生又會如何。我們一般認為，抓住了問題的關鍵，其他一切則會迎刃而解。我們都知道，只要有意義，那麼就必須慎重考慮。現在，解決中午吃什麼的問題，是非常非常重要的。所以， 那麼， 一般來講，我們都必須務必慎重的考慮考慮
				</div>
				<div class="last__row">
					<button class="more__btn">READ MORE</button>
				</div>
			</div><div class="blog">
				<div class="title__row">
					<div class="blog__title">
						嗨～歡迎來到程式新手村 feat. 胡斯的異想世界
					</div>
					<button class="edit__btn">編輯</button>
				</div>
				<div class="blog__details">
					<div class="clock__img"></div>
					<div class="blog__time">2020/07/01 10:15</div>
					<div class="blog__category">歷史公告</div>
				</div>
				<div class="blog__content">羅曼·羅蘭在不經意間這樣說過

					只有把抱怨環境的心情，化為上進的力量，才是成功的保證。
					帶著這句話，我們還要更加慎重的審視這個問題： 在這種困難的抉擇下，本人思來想去，寢食難安。我們一般認為，抓住了問題的關鍵，其他一切則會迎刃而解。
					
					郭沫若說過一句富有哲理的話，形成天才的決定因素應該是勤奮。這句話語雖然很短，但令我浮想聯翩。每個人都不得不面對這些問題。在面對這種問題時， 我認為， 生活中，若中午吃什麼出現了，我們就不得不考慮它出現了的事實。中午吃什麼，發生了會如何，不發生又會如何。我們一般認為，抓住了問題的關鍵，其他一切則會迎刃而解。我們都知道，只要有意義，那麼就必須慎重考慮。現在，解決中午吃什麼的問題，是非常非常重要的。所以， 那麼， 一般來講，我們都必須務必慎重的考慮考慮
				</div>
				<div class="last__row">
					<button class="more__btn">READ MORE</button>
				</div>
			</div>
			
		</div>
	</div>
	<footer>
		<div class="copyright">
			Copyright © 2020 Who's Blog All Rights Reserved.
		</div>
	</footer>
	<script>
		// Display hidden items when logged in
		function determineHidden (class1, class2) {
			elements = document.querySelectorAll(class1);
			elements.forEach(function(element) {
				element.classList.remove('hidden');
			});
			elements = document.querySelectorAll(class2);
			elements.forEach(function(element) {
				element.classList.add('hidden');
			});
				
		} 

		function handleSecondGroup(e) {
			target = e.target;
			
			switch (target.id) {
				case "login__btn" : 
					$('.login__wrapper').slideToggle('slow');
					break;
				case "logout__btn" :
					$.get('./api_logout.php').done(()=>{
						location.reload();
					});

					break;
				case "admin__btn" :
					console.log('admin');
					break;
				case "new__post__btn" :
					console.log('new');
					break;
			}
		}

		// Check privilege	
		const req = new XMLHttpRequest();
		req.onload = function() {
			if (req.status >= 200 && req.status <400) {
				let json = JSON.parse(req.responseText);
				if (json[0]['admin']) {
					determineHidden('.logged__in', '.logged__out');	
				} 
			}
		}
				
		req.onerror = function() {
			console.log('error');
		}
		
		req.open('GET', './check_privilege.php', true);
		req.send();
		
		// Click second group buttons
		$('.btns2').on('click', (e)=>{
			handleSecondGroup(e);
		});

		// From login from back to main page
		$('.login__wrapper').on('click', (e)=>{
			if (e.target.classList.contains('login__wrapper')){
				$("#warning__msg").html('');
				$(".login__form > input").val('');
				$('.login__wrapper').slideToggle(500);
			}
		});

		// Click login form submit button
		$('.form__btn').on('click', (e)=>{
			e.preventDefault();
			let username = $("#username").val();
			let password = $("#password").val();
			$.post( "api_login.php", { username: username, password: password })
			  .done(function(data) {
			  	msg = data[0]['msg'];
			  	if (msg === true) {
			  		location.reload();
			  	} else {
			  	  $("#warning__msg").html(msg);
				}
			  });
		});


	</script>
</body>
</html>